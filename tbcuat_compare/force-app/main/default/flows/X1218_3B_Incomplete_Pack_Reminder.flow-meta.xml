<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <actionCalls>
        <name>Noification_to_candidate</name>
        <label>Noification to candidate</label>
        <locationX>50</locationX>
        <locationY>360</locationY>
        <actionName>emailSimple</actionName>
        <actionType>emailSimple</actionType>
        <connector>
            <targetReference>Update_Contact</targetReference>
        </connector>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>senderType</name>
            <value>
                <stringValue>OrgWideEmailAddress</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>senderAddress</name>
            <value>
                <stringValue>no-reply@thebestconnection.co.uk</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>recipientId</name>
            <value>
                <elementReference>$Record.b3o__Contact__r.Id</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>logEmailOnSend</name>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>emailTemplateId</name>
            <value>
                <stringValue>00XQH000005VQ8D2AW</stringValue>
            </value>
        </inputParameters>
        <nameSegment>emailSimple</nameSegment>
        <offset>0</offset>
    </actionCalls>
    <actionCalls>
        <name>X2nd_Noification_to_candidate</name>
        <label>2nd Noification to candidate</label>
        <locationX>50</locationX>
        <locationY>768</locationY>
        <actionName>emailSimple</actionName>
        <actionType>emailSimple</actionType>
        <connector>
            <targetReference>Copy_2_of_Update_Contact</targetReference>
        </connector>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>senderType</name>
            <value>
                <stringValue>OrgWideEmailAddress</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>senderAddress</name>
            <value>
                <stringValue>no-reply@thebestconnection.co.uk</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>recipientId</name>
            <value>
                <elementReference>$Record.b3o__Contact__r.Id</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>logEmailOnSend</name>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>emailTemplateId</name>
            <value>
                <stringValue>00XQH000005VQ8D2AW</stringValue>
            </value>
        </inputParameters>
        <nameSegment>emailSimple</nameSegment>
        <offset>0</offset>
    </actionCalls>
    <apiVersion>62.0</apiVersion>
    <areMetricsLoggedToDataCloud>false</areMetricsLoggedToDataCloud>
    <decisions>
        <name>Candidate_Completed_Document_Pack</name>
        <label>Candidate Completed Document Pack?</label>
        <locationX>182</locationX>
        <locationY>252</locationY>
        <defaultConnector>
            <targetReference>Candidate_Completed_First_Reminder</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>No_Send_First_Reminder</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.b3o__Contact__r.Reminder_Email_Sent__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Initial Documents assigned</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>NumberofDays</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <numberValue>3.0</numberValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.b3o__Status__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>New</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Noification_to_candidate</targetReference>
            </connector>
            <label>No, Send First Reminder</label>
        </rules>
    </decisions>
    <decisions>
        <name>Candidate_Completed_First_Reminder</name>
        <label>Candidate Completed First Reminder?</label>
        <locationX>182</locationX>
        <locationY>660</locationY>
        <defaultConnector>
            <targetReference>Candidate_Completed_Second_Reminder</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>No_Send_2nd_Reminder</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.b3o__Contact__r.Reminder_Email_Sent__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>1st Reminder Sent</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>NumberofDays</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <numberValue>5.0</numberValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.b3o__Status__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>New</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>X2nd_Noification_to_candidate</targetReference>
            </connector>
            <label>No, Send 2nd Reminder</label>
        </rules>
    </decisions>
    <decisions>
        <name>Candidate_Completed_Second_Reminder</name>
        <label>Candidate Completed Second Reminder?</label>
        <locationX>182</locationX>
        <locationY>1068</locationY>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>No_Reject_Candidate</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.b3o__Contact__r.Reminder_Email_Sent__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>2nd Reminder Sent</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>NumberofDays</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <numberValue>7.0</numberValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.b3o__Status__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>New</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Copy_3_of_Update_Contact</targetReference>
            </connector>
            <label>No, Reject Candidate</label>
        </rules>
    </decisions>
    <environments>Default</environments>
    <formulas>
        <name>NumberofDays</name>
        <dataType>Number</dataType>
        <expression>CASE (
    MOD ({!ReminderEmailDate}  -  DATE (1985, 6, 24) , 7),
    0, CASE ( MOD ( TODAY() - {!ReminderEmailDate} , 7), 1, 2, 2, 3, 3, 4, 4, 5, 5, 5, 6, 5, 1 ), 
    1, CASE(  MOD ( TODAY() - {!ReminderEmailDate} , 7),  1, 2, 2,  3,  3, 4, 4,  4, 5, 4, 6,  5, 1 ),
    2, CASE(  MOD ( TODAY() - {!ReminderEmailDate} , 7),  1, 2, 2, 3, 3, 3,  4, 3, 5,  4, 6, 5, 1 ),
    3, CASE (  MOD ( TODAY() - ({!ReminderEmailDate} ), 7),  1, 2, 2,  2, 3, 2, 4, 3, 5,  4,  6, 5, 1 ),
    4, CASE (  MOD ( TODAY() -  {!ReminderEmailDate} , 7), 1, 1, 2,  1, 3, 2, 4, 3, 5, 4, 6, 5, 1 ),
    5, CASE (  MOD ( TODAY() - {!ReminderEmailDate} , 7), 1, 0, 2, 1, 3, 2, 4,  3, 5, 4, 6,  5, 0  ),
    6, CASE ( MOD ( TODAY() - {!ReminderEmailDate} , 7), 1, 1, 2,  2, 3,  3, 4,  4, 5, 5, 6, 5, 0 ),
    999
) + 
(FLOOR((TODAY() - {!ReminderEmailDate} ) / 7) * 5)</expression>
        <scale>0</scale>
    </formulas>
    <formulas>
        <name>ReminderEmailDate</name>
        <dataType>Date</dataType>
        <expression>DATEVALUE({!$Record.b3o__Contact__r.Doc_Assignment_Date__c})</expression>
    </formulas>
    <interviewLabel>1218 3B Incomplete Pack Reminder {!$Flow.CurrentDateTime}</interviewLabel>
    <label>1218 3B Incomplete Pack Reminder</label>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>CanvasMode</name>
        <value>
            <stringValue>AUTO_LAYOUT_CANVAS</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>OriginBuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>AutoLaunchedFlow</processType>
    <recordUpdates>
        <name>Copy_2_of_Update_Contact</name>
        <label>Update Contact</label>
        <locationX>50</locationX>
        <locationY>876</locationY>
        <connector>
            <targetReference>Candidate_Completed_Second_Reminder</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.b3o__Contact__r.Id</elementReference>
            </value>
        </filters>
        <inputAssignments>
            <field>Reminder_Email_Sent__c</field>
            <value>
                <stringValue>2nd Reminder Sent</stringValue>
            </value>
        </inputAssignments>
        <object>Contact</object>
    </recordUpdates>
    <recordUpdates>
        <name>Copy_3_of_Update_Contact</name>
        <label>Update Contact</label>
        <locationX>50</locationX>
        <locationY>1176</locationY>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.b3o__Contact__r.Id</elementReference>
            </value>
        </filters>
        <inputAssignments>
            <field>Reminder_Email_Sent__c</field>
        </inputAssignments>
        <inputAssignments>
            <field>TR1__Candidate_Status__c</field>
            <value>
                <stringValue>Rejected</stringValue>
            </value>
        </inputAssignments>
        <object>Contact</object>
    </recordUpdates>
    <recordUpdates>
        <name>Update_Contact</name>
        <label>Update Contact</label>
        <locationX>50</locationX>
        <locationY>468</locationY>
        <connector>
            <targetReference>Candidate_Completed_First_Reminder</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.b3o__Contact__r.Id</elementReference>
            </value>
        </filters>
        <inputAssignments>
            <field>Reminder_Email_Sent__c</field>
            <value>
                <stringValue>1st Reminder Sent</stringValue>
            </value>
        </inputAssignments>
        <object>Contact</object>
    </recordUpdates>
    <start>
        <locationX>56</locationX>
        <locationY>0</locationY>
        <connector>
            <targetReference>Candidate_Completed_Document_Pack</targetReference>
        </connector>
        <filterLogic>(1 OR 5) AND 2 AND (3 OR 4)</filterLogic>
        <filters>
            <field>Complete__c</field>
            <operator>LessThanOrEqualTo</operator>
            <value>
                <numberValue>99.0</numberValue>
            </value>
        </filters>
        <filters>
            <field>b3o__Status__c</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>New</stringValue>
            </value>
        </filters>
        <filters>
            <field>Document_Pack_Name__c</field>
            <operator>StartsWith</operator>
            <value>
                <stringValue>Pre-Interview</stringValue>
            </value>
        </filters>
        <filters>
            <field>Document_Pack_Name__c</field>
            <operator>StartsWith</operator>
            <value>
                <stringValue>Post Interview</stringValue>
            </value>
        </filters>
        <filters>
            <field>Complete__c</field>
            <operator>IsNull</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </filters>
        <object>b3o__Document_Assignment__c</object>
        <schedule>
            <frequency>Daily</frequency>
            <startDate>2025-01-22</startDate>
            <startTime>13:08:00.000Z</startTime>
        </schedule>
        <triggerType>Scheduled</triggerType>
    </start>
    <status>Active</status>
</Flow>
